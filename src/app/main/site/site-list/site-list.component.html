<div class="site-table">
  <h1 class="title has-text-centered has-text-info">Liste des sites</h1>
  <div class="input-label is-align-items-center mb-4">
    <!--  <label for="region" class="label">Trier par region</label>-->
    <p-dropdown
      [options]="regions"
      optionLabel="name"
      optionValue="id"
      placeholder="Trier par region"
      (onChange)="filterWithRegion($event.value)"
      id="region"></p-dropdown>
  </div>
  <p-table
    #dt
    [value]="filteredSites"
    [rows]="25"
    [paginator]="true"
    [rowsPerPageOptions]="[25, 50, 100]"
    styleClass="p-datatable-striped"
    [tableStyle]="{ 'vertical-align': 'center' }"
    [loading]="loading">
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="name">
          <i class="{{ iconSite }} mr-1"></i> Nom
          <p-sortIcon field="name"></p-sortIcon>
        </th>
        <th pSortableColumn="department.name">
          <i class="{{ iconDepartment }} mr-1"></i>DÃ©partement
          <p-sortIcon field="department.name"></p-sortIcon>
        </th>
        <th pSortableColumn="averageRouteNumber">
          <i class="{{ iconRouteNumber }} mr-1"></i> Nombre de voies
          <p-sortIcon field="averageRouteNumber"></p-sortIcon>
        </th>
        <th pSortableColumn="minLevel.label">
          <i class="{{ iconMinLevel }} mr-1"></i>Niveau Mini
          <p-sortIcon field="minLevel.label"></p-sortIcon>
        </th>
        <th pSortableColumn="maxLevel.label">
          <i class="{{ iconMaxLevel }} mr-1"></i>Niveau Maxi
          <p-sortIcon field="maxLevel.label"></p-sortIcon>
        </th>
        <th pSortableColumn="expo.label">
          <i class="{{ iconExposition }} mr-1"></i> Exposition
          <p-sortIcon field="expo.label"></p-sortIcon>
        </th>
        <th pSortableColumn="averageRouteHeight">
          <i class="{{ iconRouteHeight }} mr-1"></i> Hauteur Moyenne
          <p-sortIcon field="averageRouteHeight"></p-sortIcon>
        </th>
        <th pSortableColumn="approachTime">
          <i class="{{ iconApproachTime }} mr-1"></i> Temps d'approche
          <p-sortIcon field="approachTime"></p-sortIcon>
        </th>
      </tr>
      <tr>
        <th>
          <p-columnFilter
            field="name"
            matchMode="contains"
            [showMenu]="false"
            [showClearButton]="false">
            <ng-template
              pTemplate="filter"
              let-value
              let-filter="filterCallback">
              <span class="p-input-icon-left ml-auto">
                <i class="pi pi-search"></i>
                <input
                  pInputText
                  type="text"
                  [ngModel]="value"
                  (ngModelChange)="filter($event)"
                  placeholder="Search" />
              </span>
            </ng-template>
          </p-columnFilter>
        </th>
        <th>
          <p-columnFilter
            [showMenu]="false"
            [showClearButton]="false"
            field="department.name"
            matchMode="contains">
            <ng-template
              pTemplate="filter"
              let-value
              let-filter="filterCallback">
              <span class="p-input-icon-left ml-auto">
                <i class="pi pi-search"></i>
                <input
                  pInputText
                  type="text"
                  [ngModel]="value"
                  (ngModelChange)="filter($event)"
                  placeholder="Search" />
              </span>
            </ng-template>
          </p-columnFilter>
        </th>
        <th>
          <p-columnFilter
            [showMenu]="false"
            [showClearButton]="false"
            field="averageRouteNumber"
            matchMode="contains">
            <ng-template
              pTemplate="filter"
              let-value
              let-filter="filterCallback">
              <span class="p-input-icon-left ml-auto">
                <i class="pi pi-search"></i>
                <input
                  pInputText
                  type="text"
                  [ngModel]="value"
                  (ngModelChange)="filter($event)"
                  placeholder="Search" />
              </span>
            </ng-template>
          </p-columnFilter>
        </th>
        <th>
          <p-columnFilter
            [showMenu]="false"
            [showClearButton]="false"
            field="minLevel.label"
            matchMode="contains">
            <ng-template
              pTemplate="filter"
              let-value
              let-filter="filterCallback">
              <span class="p-input-icon-left ml-auto">
                <i class="pi pi-search"></i>
                <input
                  pInputText
                  type="text"
                  [ngModel]="value"
                  (ngModelChange)="filter($event)"
                  placeholder="Search" />
              </span>
            </ng-template>
          </p-columnFilter>
        </th>
        <th>
          <p-columnFilter
            [showMenu]="false"
            [showClearButton]="false"
            field="maxLevel.label"
            matchMode="contains">
            <ng-template
              pTemplate="filter"
              let-value
              let-filter="filterCallback">
              <span class="p-input-icon-left ml-auto">
                <i class="pi pi-search"></i>
                <input
                  pInputText
                  type="text"
                  [ngModel]="value"
                  (ngModelChange)="filter($event)"
                  placeholder="Search" />
              </span>
            </ng-template>
          </p-columnFilter>
        </th>
        <th>
          <p-columnFilter
            [showMenu]="false"
            [showClearButton]="false"
            field="expo.label"
            matchMode="contains">
            <ng-template
              pTemplate="filter"
              let-value
              let-filter="filterCallback">
              <span class="p-input-icon-left ml-auto">
                <i class="pi pi-search"></i>
                <input
                  pInputText
                  type="text"
                  [ngModel]="value"
                  (ngModelChange)="filter($event)"
                  placeholder="Search" />
              </span>
            </ng-template>
          </p-columnFilter>
        </th>
        <th>
          <p-columnFilter
            [showMenu]="false"
            [showClearButton]="false"
            field="averageRouteHeight"
            matchMode="contains">
            <ng-template
              pTemplate="filter"
              let-value
              let-filter="filterCallback">
              <span class="p-input-icon-left ml-auto">
                <i class="pi pi-search"></i>
                <input
                  pInputText
                  type="text"
                  [ngModel]="value"
                  (ngModelChange)="filter($event)"
                  placeholder="Search" />
              </span>
            </ng-template>
          </p-columnFilter>
        </th>
        <th>
          <p-columnFilter
            [showMenu]="false"
            [showClearButton]="false"
            field="approachTime"
            matchMode="contains">
            <ng-template
              pTemplate="filter"
              let-value
              let-filter="filterCallback">
              <span class="p-input-icon-left ml-auto">
                <i class="pi pi-search"></i>
                <input
                  pInputText
                  type="text"
                  [ngModel]="value"
                  (ngModelChange)="filter($event)"
                  placeholder="Search" />
              </span>
            </ng-template>
          </p-columnFilter>
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-site>
      <tr>
        <td>
          <a [routerLink]="[siteViewUrl + site.id]">{{ site.name }}</a>
        </td>
        <td>
          <span class=""> {{ site.department.name }}</span>
        </td>
        <td>
          <span class="">{{ site.averageRouteNumber }}</span>
        </td>
        <td>{{ site.minLevel.label }}</td>
        <td>{{ site.maxLevel.label }}</td>

        <td>
          <span *ngFor="let expo of site.expositions">{{ expo.label }} - </span>
        </td>
        <td>{{ site.averageRouteHeight }} metres</td>
        <td>{{ site.approachTime }} minutes</td>
      </tr>
    </ng-template>
  </p-table>
</div>
