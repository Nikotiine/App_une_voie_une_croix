<p-table
  #dt
  [value]="routesVM"
  [rows]="25"
  [paginator]="true"
  [rowsPerPageOptions]="[25, 50, 100]"
  styleClass="p-datatable-striped"
  [tableStyle]="{ 'vertical-align': 'center' }"
  [loading]="loading">
  <ng-template pTemplate="header">
    <tr>
      <th pSortableColumn="secteur.site.name">
        <i class="{{ ICON.SITE }} mr-1"></i> Site
        <p-sortIcon field="secteur.site.name"></p-sortIcon>
      </th>
      <th pSortableColumn="name">
        <i class="{{ ICON.ROUTE }} mr-1"></i> Nom de la voie
        <p-sortIcon field="name"></p-sortIcon>
      </th>

      <th pSortableColumn="secteur.name">
        <i class="{{ ICON.SECTOR }} mr-1"></i> Secteur
        <p-sortIcon field="secteur.name"></p-sortIcon>
      </th>
      <th pSortableColumn="height">
        <i class="{{ ICON.ROUTE_HEIGHT }} mr-1"></i> Hauteur
        <p-sortIcon field="height"></p-sortIcon>
      </th>
      <th pSortableColumn="level.label">
        <i class="{{ ICON.MAX_LEVEL }} mr-1"></i>Niveau
        <p-sortIcon field="level.label"></p-sortIcon>
      </th>
      <th pSortableColumn="exposition.label">
        <i class="{{ ICON.EXPOSITION }} mr-1"></i>Exposition
        <p-sortIcon field="maxLevel.label"></p-sortIcon>
      </th>
      <th pSortableColumn="exposition.label">
        <i class="{{ ICON.RATING }} mr-1"></i>Note
        <p-sortIcon field="maxLevel.label"></p-sortIcon>
      </th>
      <th pSortableColumn="createdAt">
        <i class="{{ ICON.CALENDAR }} mr-1"></i>
        Date d'ajout
        <p-sortIcon field="createdAt"></p-sortIcon>
      </th>
      <th pSortableColumn="secteur.name" *ngIf="isLogged">Coch√©e</th>
    </tr>
    <tr>
      <th>
        <p-columnFilter
          [showMenu]="false"
          [showClearButton]="false"
          field="secteur.site.name"
          matchMode="contains">
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <span class="p-input-icon-left ml-auto">
              <i class="pi pi-search"></i>
              <input
                pInputText
                type="text"
                [ngModel]="value"
                (ngModelChange)="filter($event)"
                placeholder="Search" />
            </span>
          </ng-template>
        </p-columnFilter>
      </th>
      <th>
        <p-columnFilter
          field="name"
          matchMode="contains"
          [showMenu]="false"
          [showClearButton]="false">
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <span class="p-input-icon-left ml-auto">
              <i class="pi pi-search"></i>
              <input
                pInputText
                type="text"
                [ngModel]="value"
                (ngModelChange)="filter($event)"
                placeholder="Search" />
            </span>
          </ng-template>
        </p-columnFilter>
      </th>

      <th>
        <p-columnFilter
          [showMenu]="false"
          [showClearButton]="false"
          field="secteur.name"
          matchMode="contains">
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <span class="p-input-icon-left ml-auto">
              <i class="pi pi-search"></i>
              <input
                pInputText
                type="text"
                [ngModel]="value"
                (ngModelChange)="filter($event)"
                placeholder="Search" />
            </span>
          </ng-template>
        </p-columnFilter>
      </th>
      <th>
        <p-columnFilter
          [showMenu]="false"
          [showClearButton]="false"
          field="height"
          matchMode="contains">
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <span class="p-input-icon-left ml-auto">
              <i class="pi pi-search"></i>
              <input
                pInputText
                type="text"
                [ngModel]="value"
                (ngModelChange)="filter($event)"
                placeholder="Search" />
            </span>
          </ng-template>
        </p-columnFilter>
      </th>
      <th>
        <p-columnFilter
          [showMenu]="false"
          [showClearButton]="false"
          field="level.label"
          matchMode="contains">
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <span class="p-input-icon-left ml-auto">
              <i class="pi pi-search"></i>
              <input
                pInputText
                type="text"
                [ngModel]="value"
                (ngModelChange)="filter($event)"
                placeholder="Search" />
            </span>
          </ng-template>
        </p-columnFilter>
      </th>
      <th>
        <p-columnFilter
          [showMenu]="false"
          [showClearButton]="false"
          field="exposition.label"
          matchMode="contains">
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <span class="p-input-icon-left ml-auto">
              <i class="pi pi-search"></i>
              <input
                pInputText
                type="text"
                [ngModel]="value"
                (ngModelChange)="filter($event)"
                placeholder="Search" />
            </span>
          </ng-template>
        </p-columnFilter>
      </th>
      <th>
        <p-columnFilter
          [showMenu]="false"
          [showClearButton]="false"
          field="createdAt"
          matchMode="contains">
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <span class="p-input-icon-left ml-auto">
              <i class="pi pi-search"></i>
              <input
                pInputText
                type="text"
                [ngModel]="value"
                (ngModelChange)="filter($event)"
                placeholder="Search" />
            </span>
          </ng-template>
        </p-columnFilter>
      </th>
      <th>
        <p-columnFilter
          [showMenu]="false"
          [showClearButton]="false"
          field="exposition.label"
          matchMode="contains">
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <span class="p-input-icon-left ml-auto">
              <i class="pi pi-search"></i>
              <input
                pInputText
                type="text"
                [ngModel]="value"
                (ngModelChange)="filter($event)"
                placeholder="Search" />
            </span>
          </ng-template>
        </p-columnFilter>
      </th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-route>
    <tr>
      <td>
        <a [routerLink]="[siteViewUrl + route.sector.site.id]">{{
          route.sector.site.name
        }}</a>
      </td>
      <td>
        <a [routerLink]="[routeViewUrl + route.id]"> {{ route.name }}</a>
      </td>

      <td>{{ route.sector.name }}</td>
      <td>
        <span class="">{{ route.height }}</span>
      </td>
      <td>{{ route.level.label }}</td>

      <td>{{ route.exposition.label }}</td>
      <td>
        <p-rating
          [readonly]="true"
          [stars]="route.rating"
          [cancel]="false"></p-rating>
      </td>
      <td>{{ route.createdAt | date : 'dd/MM/yyyy' }}</td>
      <td *ngIf="isLogged">
        <p-button styleClass="p-button-text"
          ><i
            class="{{
              route.checked
                ? 'fas fa-check-circle has-text-success'
                : 'far fa-circle has-text-black'
            }} is-size-4"
            (click)="
              route.checked ? alreadyChecked() : showDialog(route.id)
            "></i
        ></p-button>
      </td>
    </tr>
  </ng-template>
</p-table>
<app-notebook-form-dialog
  (isClose)="closeDialog()"
  (isSuccess)="reloadData()"
  [visible]="visible"
  [route]="selectedRoute"></app-notebook-form-dialog>
